<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=0" name="viewport">
  <meta content="yes" name="apple-mobile-web-app-capable">
  <meta content="yes" name="mobile-web-app-capable">
  <meta content="yes" name="apple-touch-fullscreen">
  <meta content="black" name="apple-mobile-web-app-status-bar-style">
  <meta content="320" name="MobileOptimized">
  <meta charset="UTF-8">
  <title>æ­£åœ¨è·³è½¬...</title>
<style>
.container {
    width: 100px;
    height: 100px;
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    animation: rotate-move 2s ease-in-out infinite;
}

.dot {
    width: 15px;
    height: 15px;
    border-radius: 50%;
    background-color: #000;
    position: absolute;
    top: 0;
    bottom: 0;
    left: 0;
    right: 0;
    margin: auto;
}

.dot-3 {
    background-color: #f74d75;
    animation: dot-3-move 2s ease infinite;
}

.dot-2 {
    background-color: #10beae;
    animation: dot-2-move 2s ease infinite;
}

.dot-1 {
    background-color: #ffe386;
    animation: dot-1-move 2s ease infinite;
}

@keyframes dot-3-move {
    20% { transform: scale(1) }
    45% { transform: translateY(-18px) scale(.45) }
    60% { transform: translateY(-25px) scale(.45) }
    80% { transform: translateY(-25px) scale(.45) }
    100% { transform: translateY(0px) scale(1) }
}

@keyframes dot-2-move {
    20% { transform: scale(1) }
    45% { transform: translate(-16px, 12px) scale(.45) }
    60% { transform: translate(-20px, 15px) scale(.45) }
    80% { transform: translate(-20px, 15px) scale(.45) }
    100% { transform: translateY(0px) scale(1) }
}

@keyframes dot-1-move {
    20% { transform: scale(1) }
    45% { transform: translate(16px, 12px) scale(.45) }
    60% { transform: translate(20px, 15px) scale(.45) }
    80% { transform: translate(20px, 15px) scale(.45) }
    100% { transform: translateY(0px) scale(1) }
}

@keyframes rotate-move {
    55% { transform: translate(-50%, -50%) rotate(0deg) }
    80% { transform: translate(-50%, -50%) rotate(360deg) }
    100% { transform: translate(-50%, -50%) rotate(360deg) }
}

.content {
    height: 100%;
    width: 100%;
    position: fixed;
    left: -2px;
    top: -2px;
}

.expire-page {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(135deg, #fff5f5 0%, #ffe0e0 100%);
    z-index: 9999;
    overflow-y: auto;
}

.expire-box {
    max-width: 90%;
    width: 360px;
    margin: 50px auto;
    padding: 30px 20px;
    background: white;
    border-radius: 20px;
    box-shadow: 0 10px 30px rgba(0,0,0,0.15);
    text-align: center;
}

.expire-icon {
    font-size: 60px;
    margin-bottom: 15px;
}

.expire-title {
    font-size: 22px;
    font-weight: bold;
    color: #333;
    margin-bottom: 10px;
}

.expire-text {
    color: #666;
    line-height: 1.6;
    margin-bottom: 20px;
    font-size: 14px;
}

.expire-days {
    color: #e74c3c;
    font-weight: bold;
}

.qr-container {
    background: #f0f8ff;
    border: 2px solid #cce5ff;
    border-radius: 12px;
    padding: 15px;
    margin: 20px 0;
}

.qr-container img {
    max-width: 180px;
    width: 100%;
    border-radius: 8px;
    margin: 10px 0;
}

.qr-tip {
    font-size: 12px;
    color: #666;
    margin-top: 8px;
}

.btn-refresh {
    width: 100%;
    background: #3498db;
    color: white;
    border: none;
    padding: 12px;
    border-radius: 8px;
    font-size: 15px;
    cursor: pointer;
    margin-top: 10px;
}

.btn-refresh:active {
    background: #2980b9;
}
</style>
</head>
<body>

<div class="container" id="loading">
    <div class="dot dot-1"></div>
    <div class="dot dot-2"></div>
    <div class="dot dot-3"></div>
</div>

<div class="expire-page" id="expirePage">
    <div class="expire-box">
        <div class="expire-icon">âš ï¸</div>
        <div class="expire-title">é“¾æ¥å·²åˆ°æœŸ</div>
        <div class="expire-text">
            è¯¥é˜²çº¢é“¾æ¥çš„ <span class="expire-days" id="expireDays"></span> æœ‰æ•ˆæœŸå·²è¿‡<br>
            è¯·è”ç³»ç®¡ç†å‘˜ç»­è´¹ä½¿ç”¨
        </div>
        
        <div class="qr-container">
            <div style="font-weight: bold; margin-bottom: 5px;">æ‰«ç è”ç³»å®¢æœç»­è´¹</div>
            <img src="https://wx.vip51688.cn/console/upload/1DhKUkqHj.jpg" alt="å®¢æœäºŒç»´ç ">
            <div class="qr-tip">å¾®ä¿¡ï¼šKMHSLXS</div>
        </div>

        <button class="btn-refresh" onclick="location.reload()">ğŸ”„ åˆ·æ–°é‡è¯•</button>
    </div>
</div>

<script>
// âœ… å°†æ‰€æœ‰é€»è¾‘åŒ…è£…åœ¨å‡½æ•°ä¸­ï¼Œé¿å…é¡¶å±‚ return é”™è¯¯
(function() {
    var liugao = new URLSearchParams(window.location.search);
    var encodedParam = liugao.get('c');

    if (!encodedParam) {
        console.log("ç¼ºå°‘å‚æ•° c");
        return; // âœ… ç°åœ¨å¯ä»¥å®‰å…¨ä½¿ç”¨ return
    }

    try {
        // è§£ç 
        var liu = decodeURIComponent(escape(atob(encodedParam)));
        console.log("è§£ç ç»“æœ:", liu);
        
        // åˆ¤æ–­æ˜¯ JSON è¿˜æ˜¯çº¯ URL
        var isJSON = false;
        var data = null;
        
        try {
            data = JSON.parse(liu);
            isJSON = true;
            console.log("JSONæ•°æ®:", data);
        } catch(e) {
            isJSON = false;
            console.log("éJSONæ ¼å¼");
        }
        
        if (isJSON && data.url && data.created !== undefined && data.expire_days !== undefined) {
            // ========== æ–°æ ¼å¼ï¼šå¸¦è¿‡æœŸéªŒè¯ ==========
            var targetUrl = data.url;
            var createdTime = data.created;
            var expireDays = data.expire_days;
            
            console.log("ç›®æ ‡URL:", targetUrl);
            console.log("åˆ›å»ºæ—¶é—´:", new Date(createdTime * 1000));
            console.log("æœ‰æ•ˆæœŸ:", expireDays, "å¤©");
            
            // æ°¸ä¹…æœ‰æ•ˆ
            if (expireDays >= 9999) {
                console.log("æ°¸ä¹…æœ‰æ•ˆé“¾æ¥");
                jumpToUrl(targetUrl);
                return; // âœ… åœ¨å‡½æ•°å†…å¯ä»¥ä½¿ç”¨
            }
            
            // æ£€æŸ¥æ˜¯å¦è¿‡æœŸ
            var currentTime = Math.floor(Date.now() / 1000);
            var elapsedDays = (currentTime - createdTime) / 86400;
            
            console.log("å·²è¿‡å¤©æ•°:", elapsedDays.toFixed(2));
            
            if (elapsedDays > expireDays) {
                console.log("é“¾æ¥å·²è¿‡æœŸ");
                showExpirePage(expireDays);
            } else {
                console.log("é“¾æ¥æœ‰æ•ˆï¼Œå‰©ä½™", (expireDays - elapsedDays).toFixed(2), "å¤©");
                jumpToUrl(targetUrl);
            }
            
        } else {
            // ========== æ—§æ ¼å¼ï¼šçº¯ URL ==========
            if (liu.includes("http")) {
                console.log("æ—§æ ¼å¼URL:", liu);
                jumpToUrl(liu);
            } else {
                console.log("æ— æ•ˆURL");
            }
        }
        
    } catch(e) {
        console.error("è§£æé”™è¯¯:", e);
    }
})(); // âœ… ç«‹å³æ‰§è¡Œå‡½æ•°

// è·³è½¬å‡½æ•°
function jumpToUrl(url) {
    console.log("è·³è½¬åˆ°:", url);
    var loading = document.getElementById("loading");
    
    setTimeout(function() {
        loading.style.display = "none";
        var html = '<iframe class="content" onload="bindMouseWhee(this)" src="' + url + '"></iframe>';
        document.write(html);
    }, 1500);
}

// æ˜¾ç¤ºè¿‡æœŸé¡µé¢
function showExpirePage(days) {
    var loading = document.getElementById("loading");
    var expirePage = document.getElementById("expirePage");
    var expireDaysSpan = document.getElementById("expireDays");
    
    loading.style.display = "none";
    expireDaysSpan.textContent = days + " å¤©";
    expirePage.style.display = "block";
}

// é¼ æ ‡æ»šè½®å…¼å®¹
var firefox = navigator.userAgent.indexOf('Firefox') != -1;

function MouseWheel(e, doc) {
    e.preventDefault && e.preventDefault();
    e.returnValue = false;
    var up = firefox && e.detail < 0 || e.wheelDelta > 0;
    doc.body.scrollTop = doc.documentElement.scrollTop += up ? -50 : 50;
}

function bindMouseWhee(ifr) {
    try {
        var doc = ifr.contentWindow.document;
        firefox ? doc.addEventListener('DOMMouseScroll', function(e) {
            MouseWheel(e, doc)
        }, false) : (doc.onmousewheel = function(e) {
            MouseWheel(e || ifr.contentWindow.event, doc)
        });
    } catch(e) {
        console.log('è·¨åŸŸé™åˆ¶:', e.message);
    }
}
</script>

</body>
</html>
